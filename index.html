<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pseudo Live Stream</title>
  <style>
    body {
      background: #000;
      color: #fff;
      margin: 0;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      font-family: Arial, sans-serif;
    }

    #video-container, #fallback-message {
      display: none;
    }

    .video-wrapper {
      position: relative;
      width: 90vw;
      max-width: 960px;
      aspect-ratio: 16 / 9;
      overflow: hidden;
      border-radius: 8px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.8);
    }

    iframe {
      width: 100%;
      height: 100%;
      border: none;
      pointer-events: none;
    }

    .click-to-unmute {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, #00c6ff, #0072ff);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 3;
      font-size: 1.8rem;
      font-weight: bold;
      cursor: pointer;
      animation: pulse 1.5s infinite;
      text-shadow: 1px 1px 4px #000;
      user-select: none;
      border-radius: 8px;
    }

    @keyframes pulse {
      0% { opacity: 0.7; }
      50% { opacity: 1; }
      100% { opacity: 0.7; }
    }

    .scroll-banner {
      position: absolute;
      bottom: 0;
      width: 100%;
      background: rgba(0, 0, 0, 0.75);
      color: #fff;
      font-size: 1rem;
      padding: 5px 0;
      white-space: nowrap;
      overflow: hidden;
      z-index: 4;
    }

    .scroll-banner span {
      display: inline-block;
      padding-left: 100%;
      animation: scroll-left 15s linear infinite;
    }

    @keyframes scroll-left {
      0% { transform: translateX(0); }
      100% { transform: translateX(-100%); }
    }
  </style>
</head>
<body>

  <div id="video-container">
    <div class="video-wrapper">
      <div id="player"></div>
      <div class="click-to-unmute" id="unmute-overlay">üîä Tap to Unmute</div>
      <div class="scroll-banner"><span>üì∫ Pseudo-Live ‚Äî No Skipping | Optimized for Chrome & iOS | Now Playing</span></div>
    </div>
  </div>

  <div id="fallback-message">
    <h2>‚ö†Ô∏è This livestream is only available in Google Chrome (desktop/Android) and Safari/Chrome on iOS.</h2>
    <p>Please use one of these browsers to view the video.</p>
  </div>

  <script>
    const playlist = [
      { id: "MFLVmAE4cqg", duration: 55 },
      { id: "QmSDEeAZB1g", duration: 46 },
      { id: "JEUsXoAKFag", duration: 57 }
    ];

    // Set your live start time here (UTC)
    const LIVE_START_TIME = new Date("2025-08-21T14:00:00Z").getTime();

    let player;
    let userUnmuted = false;

    function isAllowedBrowser() {
      const ua = navigator.userAgent;
      const isAndroid = /Android/i.test(ua);
      const isIOS = /iPhone|iPad|iPod/i.test(ua);

      const isDesktopChrome = /Chrome\/[.0-9]* Safari\/[.0-9]*$/.test(ua) &&
        !/Edg|OPR|Brave|Vivaldi/i.test(ua);

      const isChromeOnAndroid = isAndroid &&
        /Chrome\/[.0-9]* Mobile/i.test(ua) &&
        !/EdgA|OPR|Brave|SamsungBrowser/i.test(ua);

      const isChromeOniOS = isIOS && /CriOS/i.test(ua);
      const isSafariOniOS = isIOS && /Version\/[\d\.]+.*Safari/.test(ua);

      return isDesktopChrome || isChromeOnAndroid || isChromeOniOS || isSafariOniOS;
    }

    function onYouTubeIframeAPIReady() {
      if (!isAllowedBrowser()) {
        document.getElementById("fallback-message").style.display = "block";
        return;
      }

      document.getElementById("video-container").style.display = "block";

      const now = Date.now();
      const elapsed = Math.floor((now - LIVE_START_TIME) / 1000);
      let videoIndex = 0;
      let cumulative = 0;

      // Find the correct video and time offset
      for (let i = 0; i < playlist.length; i++) {
        const video = playlist[i];
        if (elapsed < cumulative + video.duration) {
          videoIndex = i;
          break;
        }
        cumulative += video.duration;
      }

      const currentVideo = playlist[videoIndex];
      const offset = Math.max(0, elapsed - cumulative);

      loadVideo(currentVideo.id, offset, videoIndex);
    }

    function loadVideo(videoId, startSeconds, videoIndex) {
      const playerDiv = document.getElementById("player");
      playerDiv.innerHTML = "";

      player = new YT.Player("player", {
        videoId,
        playerVars: {
          autoplay: 1,
          mute: 1,
          controls: 0,
          disablekb: 1,
          modestbranding: 1,
          rel: 0,
          playsinline: 1,
          start: startSeconds
        },
        events: {
          onReady: (event) => {
            event.target.playVideo();
            if (userUnmuted) {
              event.target.unMute();
              document.getElementById("unmute-overlay").style.display = "none";
            }
          },
          onStateChange: (event) => {
            if (event.data === YT.PlayerState.ENDED) {
              const nextIndex = videoIndex + 1;
              if (nextIndex < playlist.length) {
                setTimeout(() => {
                  loadVideo(playlist[nextIndex].id, 0, nextIndex);
                }, 500);
              } else {
                // Loop last video
                loadVideo(playlist[playlist.length - 1].id, 0, playlist.length - 1);
              }
            }
          }
        }
      });
    }

    document.addEventListener("click", () => {
      const overlay = document.getElementById("unmute-overlay");
      if (overlay && player && typeof player.unMute === "function") {
        player.unMute();
        userUnmuted = true;
        overlay.style.display = "none";
      }
    }, { once: true });

    const tag = document.createElement("script");
    tag.src = "https://www.youtube.com/iframe_api";
    document.head.appendChild(tag);
  </script>

</body>
</html>
